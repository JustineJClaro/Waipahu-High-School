<!DOCTYPE html>
<html lang="en">

<head>
  <title>Waipahu HS Bulletin</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap 5.3 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="container-fluid p-4 bg-primary text-white text-center">
    <h1>Waipahu High School</h1>
  </div>

  <main class="container mt-4">
    <h2 class="text-center">News and Announcements</h2>
    <h2 id="todayDate" class="text-center mb-4"></h2>

    <h3>ðŸ“¢ School Announcements</h3>
    <div class="accordion" id="notifications"></div>

    <script>
      async function loadGoogleDoc() {
        try {
          const response = await fetch('https://api.allorigins.win/raw?url=https://docs.google.com/document/d/e/2PACX-1vSBGOtfDF_UpFHYH1iBlzBGdUODeeMWT97IPv4aFsWw_W4eyjollFtvN0yRe7FXj62h-agAppMkKPA0/pub');
          const html = await response.text();

          const parser = new DOMParser();
          const doc = parser.parseFromString(html, 'text/html');
          const paragraphs = doc.querySelectorAll('p');

          const accordion = document.getElementById('notifications');
          accordion.innerHTML = '';

          const maxNotifications = 5;
          let index = 0;

          for (let p of paragraphs) {
            const text = p.innerText.trim();
            if (text.length < 5 || text.length > 1000) continue;

            const item = document.createElement('div');
            item.className = 'accordion-item';
            item.innerHTML = `
              <h2 class="accordion-header" id="heading${index}">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                  data-bs-target="#collapse${index}" aria-expanded="false" aria-controls="collapse${index}">
                  Notification ${index + 1}
                </button>
              </h2>
              <div id="collapse${index}" class="accordion-collapse collapse" aria-labelledby="heading${index}">
                <div class="accordion-body">${text.replace(/\n/g, '<br>')}</div>
              </div>
            `;
            accordion.appendChild(item);
            index++;

            if (index >= maxNotifications) break;
          }

        } catch (error) {
          console.error('Failed to load Google Doc content:', error);
        }
      }

      loadGoogleDoc();
    </script>

    <hr>

    <!-- Today's Schedule -->
    <div class="panel-group border rounded p-3">
      <h4><strong>Today's Schedule</strong></h4>
      <h5 id="today" class="text-primary mb-2"></h5>
      <iframe src="https://www.waipahuhigh.org/STUDENTBELLSCHEDULE2023-2024.pdf"
        width="100%" height="600px" type="application/pdf"></iframe>
    </div>

    <hr>

    <!-- Announcement Card -->
    <div class="container mt-4">
      <img src="https://www.waipahuhigh.org/ourpages/auto/2025/4/1/45166328/class%20of%202026%20junior%20year%20-%20family%20night%20instagram%20post%20color_thumb.jpg?1743528916000"
        alt="Image preview" height="75">
      <br>
      <a href="https://www.waipahuhigh.org/apps/news/show_news.jsp?REC_ID=960390&id=0">Class of 2026 Junior Year - Family Night</a>
      <p>
        Wednesday, April 23, 2025 â€” 5:30 PM Check-In & Dinner, 6:00 PM Program Begins. <br>
        The College Center will be hosting a C/O 2026 Junior Year Family Night on Wednesday, April 23rd, at 6:00 PM in the school cafeteria. <br>
        Pacific University Oregon Associate Director, Donna Ramos Barsana, will share tips on applying to colleges. <br>
        RSVP: <a href="https://tinyurl.com/26springfamilynight">tinyurl.com/26springfamilynight</a>
      </p>
    </div>
  </main>

  <script>
    // Display today's date and schedule
    const d = new Date();
    document.getElementById("todayDate").textContent = `${d.getFullYear()}-${d.getMonth() + 1}-${d.getDate()}`;

    const day = d.getDay();
    const schedule = ["NO SCHOOL", "MONDAY SCHEDULE", "TUESDAY SCHEDULE", "WEDNESDAY SCHEDULE", "THURSDAY SCHEDULE", "FRIDAY SCHEDULE", "NO SCHOOL"];
    document.getElementById("today").textContent = schedule[day];
  </script>
</body>

</html>
